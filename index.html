<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>Endless Bouncer</title>
    <style>
        body {
            margin: 0;
            background: linear-gradient(135deg, #1b2735, #090a0f);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            color: #eee;
        }

        #gameContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
            border: 3px solid #61dafb;
            box-shadow: 0 0 30px #61dafb80;
            overflow: hidden;
            background: radial-gradient(circle at center, #121926 0%, #0b0f19 80%);
            user-select: none;
        }

        #character {
            width: 50px;
            height: 50px;
            position: absolute;
            background: url("character.png") center/contain no-repeat;
            filter: drop-shadow(0 0 6px #61dafb);
            transition: transform 0.1s ease;
            will-change: transform;
            /* bonus: subtle floating animation */
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-6px);
            }
        }

        .brick {
            position: absolute;
            width: 80px;
            height: 15px;
            background: linear-gradient(135deg, #61dafb, #21a1f1);
            border-radius: 8px;
            box-shadow:
                0 2px 5px rgba(33, 161, 241, 0.6),
                inset 0 0 8px #a4d8ff;
            transition: background 0.3s ease;
        }

        .brick:hover {
            background: linear-gradient(135deg, #21a1f1, #61dafb);
            box-shadow:
                0 4px 12px rgba(33, 161, 241, 0.9),
                inset 0 0 12px #c4e9ff;
        }

        #scoreDisplay {
            position: absolute;
            top: 15px;
            left: 15px;
            color: #61dafb;
            font-size: 24px;
            font-weight: 700;
            text-shadow: 0 0 8px #61dafb99;
            user-select: none;
            z-index: 10;
            font-family: 'Consolas', monospace;
        }

        #scoreDisplay:hover {
            color: #ffffff;
            text-shadow: 0 0 12px #ffffff;
            transition: all 0.3s ease;
        }


        #gameOverScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 15, 30, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #61dafb;
            z-index: 20;
            text-align: center;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        #gameOverScreen h1 {
            font-size: 48px;
            margin: 0 0 10px 0;
            text-shadow: 0 0 10px #61dafb;
        }

        #gameOverScreen p {
            font-size: 22px;
            margin: 0 0 20px 0;
            font-weight: 600;
            text-shadow: 0 0 6px #61dafb88;
        }

        #restartButton {
            padding: 12px 28px;
            font-size: 20px;
            background: #21a1f1;
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            box-shadow:
                0 4px 15px #21a1f1cc;
            transition: background 0.3s ease, box-shadow 0.3s ease;
            user-select: none;
        }

        #restartButton:hover {
            background: #61dafb;
            box-shadow:
                0 6px 20px #61dafbcc;
        }

        #restartButton:active {
            background: #1992d4;
            box-shadow: none;
            transform: scale(0.97);
        }
    </style>
</head>

<body>
    <div id="gameContainer">
        <div id="scoreDisplay">Score: 0</div>
        <div id="character"><img id="character" src="character.jpg" alt=""></div>
        <div id="gameOverScreen">
            <h1>Game Over</h1>
            <p id="finalScore">Your Score: 0</p>
            <button id="restartButton">Restart</button>
        </div>
    </div>

    <script>
        const container = document.getElementById("gameContainer");
        const character = document.getElementById("character");
        const scoreDisplay = document.getElementById("scoreDisplay");
        const gameOverScreen = document.getElementById("gameOverScreen");
        const finalScoreDisplay = document.getElementById("finalScore");
        const restartButton = document.getElementById("restartButton");

        const GRAVITY = 0.8;
        const HORIZONTAL_SPEED = 7;
        const JUMP_POWER = 18;
        const AIR_CONTROL_SPEED = 0.3;
        const CHARACTER_WIDTH = 50;
        const CHARACTER_HEIGHT = 50;
        const BRICK_WIDTH = 80;
        const BRICK_HEIGHT = 15;
        const TOTAL_BRICKS = 8;
        const SCROLL_THRESHOLD = window.innerHeight / 2.5;

        let positionX, positionY, velocityX, velocityY;
        let isJumping = false;
        let jumpCount = 0;  // Track jumps for double jump
        let score = 0;
        let highestY = 0;
        let gameState = 'playing';
        let bricks = [];

        const keysPressed = {
            left: false,
            right: false,
            up: false,
        };

        function resetGame() {
            positionX = container.clientWidth / 2 - CHARACTER_WIDTH / 2;
            positionY = container.clientHeight - CHARACTER_HEIGHT - 50;
            velocityX = 0;
            velocityY = 0;
            isJumping = false;
            jumpCount = 0;  // reset jump count on game start
            score = 0;
            highestY = positionY;

            character.style.left = positionX + 'px';
            character.style.top = positionY + 'px';
            scoreDisplay.textContent = 'Score: 0';
            gameOverScreen.style.display = 'none';

            bricks.forEach(b => b.remove());
            bricks = [];
            createInitialBricks();
            gameState = 'playing';
            requestAnimationFrame(gameLoop);
        }

        function createInitialBricks() {
            createBrick(container.clientWidth / 2 - BRICK_WIDTH / 2, container.clientHeight - 50);
            for (let i = 0; i < TOTAL_BRICKS; i++) {
                const x = Math.random() * (container.clientWidth - BRICK_WIDTH);
                const y = container.clientHeight - 150 - i * 100;
                createBrick(x, y);
            }
        }

        function createBrick(x, y) {
            const brick = document.createElement("div");
            brick.className = "brick";
            brick.style.left = x + "px";
            brick.style.top = y + "px";
            container.appendChild(brick);
            bricks.push(brick);
        }

        window.addEventListener('keydown', (e) => {
            if (gameState !== 'playing') return;

            if (e.key === 'ArrowLeft') keysPressed.left = true;
            if (e.key === 'ArrowRight') keysPressed.right = true;
            if (e.key === 'ArrowUp' || e.key === ' ') {
                if (jumpCount < 2) {  // allow jump if less than 2 jumps used (double jump)
                    keysPressed.up = true;
                    let direction = 0;
                    if (keysPressed.left && !keysPressed.right) direction = -1;
                    else if (keysPressed.right && !keysPressed.left) direction = 1;
                    jump(direction);
                    jumpCount++;  // increment jump count on every jump
                }
            }
        });

        window.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowLeft') keysPressed.left = false;
            if (e.key === 'ArrowRight') keysPressed.right = false;
            if (e.key === 'ArrowUp' || e.key === ' ') keysPressed.up = false;
        });

        function jump(direction) {
            velocityY = -JUMP_POWER;
            velocityX = HORIZONTAL_SPEED * direction;
            isJumping = true;
        }

        function checkCollisions() {
            let landed = false;
            for (const brick of bricks) {
                const bTop = brick.offsetTop;
                const bLeft = brick.offsetLeft;

                if (
                    velocityY > 0 &&
                    positionY + CHARACTER_HEIGHT >= bTop &&
                    positionY + CHARACTER_HEIGHT <= bTop + BRICK_HEIGHT &&
                    positionX + CHARACTER_WIDTH > bLeft &&
                    positionX < bLeft + BRICK_WIDTH
                ) {
                    positionY = bTop - CHARACTER_HEIGHT;
                    velocityY = 0;
                    isJumping = false;
                    landed = true;
                    jumpCount = 0; // reset jump count on landing
                }
            }

            if (!landed && positionY + CHARACTER_HEIGHT >= container.clientHeight) {
                endGame();
            }
        }

        function endGame() {
            gameState = 'gameOver';
            finalScoreDisplay.textContent = `Your Score: ${score}`;
            gameOverScreen.style.display = 'flex';
        }

        function gameLoop() {
            if (gameState !== 'playing') return;

            velocityY += GRAVITY;

            if (isJumping) {
                if (keysPressed.left && !keysPressed.right) velocityX -= AIR_CONTROL_SPEED;
                if (keysPressed.right && !keysPressed.left) velocityX += AIR_CONTROL_SPEED;
            } else {
                // Reset horizontal velocity when on ground to prevent extra sliding
                velocityX = 0;
                if (keysPressed.left && !keysPressed.right) positionX -= 3;
                if (keysPressed.right && !keysPressed.left) positionX += 3;
            }

            positionX += velocityX;
            positionY += velocityY;

            // Bounds
            if (positionX < 0) {
                positionX = 0;
                velocityX *= -0.5;
            } else if (positionX > container.clientWidth - CHARACTER_WIDTH) {
                positionX = container.clientWidth - CHARACTER_WIDTH;
                velocityX *= -0.5;
            }

            checkCollisions();

            // Scrolling
            if (positionY < SCROLL_THRESHOLD) {
                const scrollAmount = SCROLL_THRESHOLD - positionY;
                positionY += scrollAmount;
                bricks.forEach(brick => {
                    brick.style.top = brick.offsetTop + scrollAmount + "px";
                });
                highestY -= scrollAmount;
            }

            const currentScore = Math.floor((highestY - positionY) / 10);
            if (currentScore > score) {
                score = currentScore;
                scoreDisplay.textContent = "Score: " + score;
            }

            // Apply to character
            character.style.left = positionX + 'px';
            character.style.top = positionY + 'px';

            // Recycle bricks
            bricks.forEach(brick => {
                if (brick.offsetTop > container.clientHeight) {
                    brick.style.top = brick.offsetTop - container.clientHeight - 200 + "px";
                    brick.style.left = Math.random() * (container.clientWidth - BRICK_WIDTH) + "px";
                }
            });

            requestAnimationFrame(gameLoop);
        }

        restartButton.addEventListener("click", resetGame);
        resetGame();
    </script>
</body>

</html>